references = [
    {
        "id":"KDT",
        "authors":"Feldman, Ronen; Dagan, Ido",
        "year":"1995",
        "title":"Knowledge Discovery in Textual Databases (KDT)",
        "in":"Proceedings of the First International Conference on Knowledge Discovery and Data Mining",
        "pages":"112-117",
        "publisher":"AAAI Press",
        "location":"Montreal, Kanada",
        "url":"http://dl.acm.org/citation.cfm?id=3001335.3001354"
    },
    {
        "id":"TextMining",
        "authors":"Hohto, Andreas; Nürnberger, Andreas; Paaß, Gerhard",
        "year":"2005",
        "title":"A brief survey of text mining",
        "in":"LDV Forum - GLDV Journal for Computational Linguistics and Language Technology"
    },
    {
        "id":"Schema.orgNoGrammar",
        "authors":"Schema.org",
        "year":"2017",
        "title":"http://schema.org/docs/datamodel.html",
        "url":"http://schema.org/docs/datamodel.html",
        "date":"2017-01-09"
    },
    {
        "id":"DavidisKochbuch",
        "authors":"Davidis, Henriette",
        "year":"1849",
        "title":"Praktisches Kochbuch für die gewöhnliche und feinere Küche, 4. vermehrte u. verbesserte Auflage",
        "publisher":"Velhagen und Klasing",
        location:"Bielefeld"
    },
    {
        "id":"DavidisKochbuchDTA",
        "authors":"Deutsches Textarchiv (A)",
        "year":"2008",
        "title":"Davidis, Henriette: Praktisches Kochbuch für die gewöhnliche und feinere Küche. 4. Aufl. Bielefeld, 1849 - Digitalisiert vom Deutschem Text Archiv",
        "location":"Berlin-Brandenburgische Akademie der Wissenschaften",
        "url":"http://www.deutschestextarchiv.de/book/show/davidis_kochbuch_1849",
        "date":"2017-01.06"
    },
    {
        "id":"ZielDTA",
        "authors":"Deutsches Textarchiv (B)",
        "year":"2017",
        "title":"DTA - Projektüberblick",
        "location":"Berlin-Brandenburgische Akademie der Wissenschaften",
        "url":"http://www.deutschestextarchiv.de/doku/ueberblick",
        "date":"2017-01.07"
    },
    {
        "id":"TEI",
        "authors":"TEI-Konsortium (A)",
        "year":"2017",
        "title":"TEI-Konsortium",
        "location":"University of Virginia Library, Charlottesville VA 22904-4114, USA",
        "url":"http://www.tei-c.org/index.xml"
    },
    {
        "id":"TEIP5",
        "authors":"TEI-Konsortium (B)",
        "year":"2017",
        "title":"TEI P5: Guidelines for Electronic Text Encoding and Interchange. Version 3.1.0.",
        "url":"http://www.tei-c.org/Guidelines/P5/",
        "date":"2017-01-07"
    },
    {
        "id":"ChefkochPfannekuchen",
        "authors":"06onkel von Chefkoch.de",
        "year":"2017",
        "title":"Rezept für Pfannekuchen",
        "url":"http://www.chefkoch.de/rezepte/363861121870267/Pfannekuchen.html",
        "date":"2017-01-07"
    },
    {
        "id":"CRFNYT",
        "authors":"Greene, Erica",
        "year":"2015",
        "title":"Extracting Structured Data From Recipes Using Conditional Random Fields",
        "in":"The New York Times",
        "url":"https://open.blogs.nytimes.com/2015/04/09/extracting-structured-data-from-recipes-using-conditional-random-fields/?_r=1",
        "date":"2017-01-08"
    },
    {
        "id":"SemanticWeb",
        "authors":"Berners-Lee, Tim; Hendler, James; Lassila, Ora",
        "year":"2001",
        "title":"The Semantic Web",
        "in":"Scientific American, 2001-05, S. 29-37"
    },
    {
        "id":"WWWCERN",
        "authors":"Berners-Lee, Tim",
        "year":"1989",
        "title":"Information Management: A Proposal",
        "url":"https://www.w3.org/History/1989/proposal.html"
    },
    {
        "id":"manualTaggingErrorProne",
        "authors":"Erdmann, M.; Maedche, A.; Schnurr, H.-P.; Staab, S.",
        "year":"2001",
        "title":"From Manual to Semi-automatic Semantic Annotation: About Ontology-based Text Annotation Tools"
    },
    {
        "id":"SkipThePizza",
        "authors":"Skip The Pizza auf WordPress.org",
        "year":"2012",
        "title":"Skip The Pizza",
        "url":"http://skipthepizza.com/blog/analyzing-the-ingredients-of-29200-recipes",
        "date":"2016-10-28"
    }, 
    {
        "id":"CRFIntroduction",
        "authors":"Sutton, Charles; McCallum, Andrew",
        "year":"2012",
        "title":"An Introduction to Conditional Random Fields",
        "url":"http://dx.doi.org/10.1561/2200000013"
    },
    {
        "id":"DictBased1",
        "authors":"Zeeshan, Ahmed",
        "year":"2009",
        "title":"Domain Specific Information Extraction for Semantic Annotation",
        "location":"Diplom-Arbeit an der Charles University in Prague, Tschechien und der University of Nancy in Frankreich"
    },
    {
        "id":"DictBased2",
        "authors":"Wiegand, Michael; Roth, Benjamin; Klakow, Dietrich",
        "year":"2012",
        "title":"Data-driven Knowledge Extraction for the Food Domain",
        "location":"Saarbrücken, Deutschland"
    },
    {
        "id":"FlavorNetwork",
        "authors":"Ahn, Yong-Yeol; Ahnert, Sebastian E.; Bagrow, James P.; Barabási, Albert-László",
        "year":"2011",
        "title":"Flavor network and the principles of food pairing",
        "url":"http://www.nature.com/articles/srep00196",
        "date":"2017-01-14"
    },
    {
        "id":"rcpRec1",
        "authors":"Ueda, Mayumi; Takahata, Mari; Nakajima, Shinsuke",
        "year":"2011",
        "title":"User&#39;s Food Preference Extraction for Personalized Cooking Recipe Recommendation",
        "url":"http://dl.acm.org/citation.cfm?id=2887675.2887686"
    },
    {
        "id":"rcpRec2",
        "authors":"Teng, Chun-Yuen; Lin, Yu-Ru; Adamic, Lada A.",
        "year":"2012",
        "title":"Recipe Recommendation Using Ingredient Networks",
        "url":"http://doi.acm.org/10.1145/2380718.2380757"
    },
    {
        "id":"rcpRec3",
        "authors":"Freyne, Jill; Berkovsky, Shlomo",
        "year":"2010",
        "title":"Recommending Food: Reasoning on Recipes and Ingredients",
        "url":"http://dx.doi.org/10.1007/978-3-642-13470-8_36"
    },
    {
        "id":"rcpRec4",
        "authors":"Geleijnse, Gijs; Overbeek, Thérèse; Veeken, Nick van der; Willemsen, Martijn",
        "year":"2010",
        "title":"Extracting Vegetable Information from Recipes to Facilitate Health-Aware Choices"
    },
    {
        "id":"deutscheHistorischeKochbuecher",
        "authors":"Henning, Beate",
        "year":"2008",
        "title":"Daz ist ein guot geriht und versaltz ez niht",
         "in":"Texte für Technik - Ausgabe Herbst 2008",
         "pages":"4-5"
    },
    {
        "id":"Retrospective",
        "authors":"Kerth, Norman L.",
        "year":"2001",
        "title":"Project Retrospectives: A Handbook for Team Reviews"
    },
    {
        "id":"thesaurusAlignmentTask",
        "authors":"Hage, Willem Robert van; Sini, Margherita; Finch, Lori; Kolb, Hap; Schreiber, Guus",
        "year":"2008",
        "title":"The OAEI food task: an analysis of a thesaurus alignment task"
    },
    {
        "id":"SemanticWeb2",
        "authors":"Kashyap, Vipul; Bussler, Christoph; Moran, Matthew",
        "year":"2008",
        "title":"The Semantic Web",
        "publisher":"Springer-Verlag Berlin Heidelberg"
    },
    {
        "id":"KnowledgeIsPower",
        "authors":"Imam Ali",
        "year":"ca. 599-661 n.Chr.",
        "title": "Nahj Al-Balagha, Saying 146",
    }
]


$("span[cite]").each(function() {
    var stem = $(this)[0].hasAttribute("stem") ? $(this).attr("stem") : "";
    var supplement = $(this)[0].hasAttribute("supplement") ? $(this).attr("supplement") : "";
    $(this).html(cite($(this).attr("cite"), stem, supplement));
});



function cite(id, stem, supplement) {
    for(var i=0; i<references.length; i++) {
       if(references[i].id == id) {
           return ref2Cite(references[i], stem, supplement);
       }
    }
}

function ref2Cite(ref, stem, supplement){
    var href = "Quellen.html#" + ref.id;
    return "<a href='" + href + "' title='" + ref.title + "'> \
                (" + stem + getAuthorRepresentationOfRef(ref) + ", " + ref.year + supplement + ") \
            </a>";
}

function getBibliography() {
    refs = references.sort(function(a,b) {
       return a.authors > b.authors;
    });
    
    var result = "";
    for(var i=0; i<refs.length; i++) {
        result += ref2Bib(references[i]);
    }
    return result;
}

function ref2Bib(ref) {
    var result = '<div id="' + ref.id + '" class="referenceEntry"><p id="'+ ref.id+"P" +'">';
    result += '<b>'+ref.authors+' (' + ref.year +'). </b>';
    result += '"' + ref.title + '". ';
    if(ref.hasOwnProperty("in")) {
        result += 'In: ' + ref.in + ". ";
    }
    if(ref.hasOwnProperty("pages")) {
        result += "S. " + ref.pages + ". ";
    }
    if(ref.hasOwnProperty("location")) {
        result += ref.location + ". ";
    }
    if(ref.hasOwnProperty("publisher")) {
        result += ref.publisher + ". ";
    }
    if(ref.hasOwnProperty("url")) {
        result += '<a href="' + ref.url + '">' + ref.url + '</a>. ';
    }
    if(ref.hasOwnProperty("date")) {
        result += "Abgerufen am " + ref.date + ". ";
    }
    return result + '</p></div>';
}

function getAuthorRepresentationOfRef(ref) {
    var authors = ref.authors.split("; ");
    return (authors.length > 2) ? authors[0].split(",")[0]+" et al." : getLastNamesString(authors);
}

function getLastNamesString(authors) {
    var result = [];
    for(var i=0; i<authors.length; i++) {
        result.push(authors[i].split(",")[0]);
    }
    return result.join(", ");
}